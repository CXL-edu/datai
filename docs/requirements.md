# 数源智能 Requirements

更新时间：2026-02-19
说明：本文件是 `docs/prd.md` 的需求细化文档，不替代 PRD 主文档。

## 1. 产品目标
数源智能（Datai）是一个面向电子表格场景的数据分析 AI Agent Web 应用。  
核心目标是：让用户上传表格后，通过流式对话快速得到可解释、可复核、可视化的分析结果。

## 2. MVP 范围（阶段 1）

### 2.1 输入与交互
- 支持上传单个文件（CSV/XLSX）。
- 支持单文件多 sheet 分析。
- 交互形态为流式 Chat，不做 Notebook Cell。
- 提供可展开任务状态面板（Task Status Panel），显示 AI 执行动作与状态。
- 面板文案由低成本 UI 模型生成，主模型不直接产出 UI 装饰性内容。

### 2.2 分析能力
- 数据读取与字段识别（数值、类别、时间、文本）。
- 统计摘要（样本量、缺失率、分布概览、关键异常）。
- 基础数据清洗（缺失值、重复值、异常值）并给出处理理由。
- 分析结论生成（围绕用户问题，输出可执行建议）。

默认建议顺序（可被动态流程覆盖）：
1. 生成统计摘要
2. 提取分析诉求
3. 生成清洗策略并执行
4. 进入分析与可视化

### 2.3 可视化与报告
- 自动图表规划与渲染（先以常见统计图为主）。
- 输出简版图文报告（结论、图表、关键指标、后续建议）。

### 2.4 约束
- 固定后端地址：`127.0.0.1:8000`。
- 先做 Web，不做桌面化。
- 先不做完整 RAG，仅预留模块和文档。
- UI 模型输出绝不回灌主模型上下文。

## 3. 阶段 2 范围
- 多文件关联分析（跨文件 join、对齐与口径说明）。
- 完整图文报告模板（分章节与可追溯引用）。
- RAG-lite 接入（小规模高质量知识片段，不做全量爬取）。

## 4. 非目标（当前不做）
- Notebook Cell 交互模式。
- Electron 套壳与桌面打包。
- 复杂鉴权与动态端口协商。
- 大规模向量检索和全量知识爬虫。

## 5. 关键验收标准（阶段 1）
- 用户可在一次会话中完成：上传 -> 提问 -> 查看流式分析 -> 查看图表 -> 获取简版报告。
- 任务状态面板可折叠/展开，展开后可查看动作日志与结果片段。
- 分析结果至少包含：数据摘要、清洗说明、图表结论、下一步建议。
- 系统错误可被感知并有可读提示，不出现“静默失败”。

## 6. 质量评测维度（阶段 1）
- 相关性：输出是否符合用户意图。
- 有用性：建议是否可被用户采纳。
- 清晰度：表达是否简洁易懂。
- 可执行性：建议是否能直接执行。
- 动作信息完整性：关键步骤是否有记录。
- 动作顺序准确性：执行轨迹是否可追溯。
- 对象细节准确性：字段、筛选条件、指标等细节是否正确。
